@namespace DayLog.Components.Layout
@using Microsoft.AspNetCore.Components.Routing
@inject NavigationManager Navigation

<!-- Sidebar navigation with search -->
<div class="navmenu-container">
    <ul class="sidebar-nav">
        <li class="nav-item">
            <NavLink class="nav-link" href="/timeline" Match="NavLinkMatch.All">Timeline</NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link" href="/dashboard">Dashboard</NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link" href="/calendar">Calendar</NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link" href="/entry">New Entry</NavLink>
        </li>
        <li class="nav-item">
            <NavLink class="nav-link" href="/settings">Settings</NavLink>
        </li>
    </ul>
    <form class="sidebar-search" role="search" onsubmit="return false;">
        <input class="form-control" placeholder="Search entries..." @oninput="OnSearchInput" />
        <button class="btn btn-outline-secondary" type="button" @onclick="GoSearch">Search</button>
    </form>
</div>
<div>
    <ul>
        <li>
            <NavLink class="nav-link" href="/settings">Settings</NavLink>
        </li>
    </ul>
    <form class="sidebar-search" role="search" onsubmit="return false;">
        <input class="form-control" placeholder="Search entries..." @oninput="OnSearchInput" />
        <button class="btn btn-outline-secondary" type="button" @onclick="GoSearch">Search</button>
    </form>
</div>

@code {
    private string _query = string.Empty;

    private void OnSearchInput(ChangeEventArgs e)
    {
        _query = e?.Value?.ToString() ?? string.Empty;
    }

    private void GoSearch()
    {
        if (string.IsNullOrWhiteSpace(_query))
        {
            Navigation.NavigateTo("/timeline");
        }
        else
        {
            Navigation.NavigateTo($"/timeline?query={Uri.EscapeDataString(_query)}");
        }
    }
}
