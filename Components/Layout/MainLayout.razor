@namespace DayLog.Components.Layout
@inherits LayoutComponentBase

@using DayLog.Components.Layout

@inject DayLog.Services.Interfaces.IAuthService AuthService
@inject NavigationManager Navigation

<div class="app-shell">
    <aside class="sidebar" role="navigation">
        <div class="sidebar-inner">
            <div class="brand">
                <img src="images/appicon.svg" alt="logo" />
                <span class="brand-title">DayLog</span>
            </div>
            <NavMenu />
        </div>
    </aside>

    <div class="content-area">
        <header class="topbar">
            <button class="hamburger d-lg-none" @onclick="ToggleSidebar" aria-label="Toggle navigation">
                &#9776;
            </button>
            <div class="topbar-right">
                <!-- optional: page title, user actions -->
            </div>
        </header>

        <main class="main-container">
            @Body
        </main>

        <footer class="app-footer">
            <small>&copy; @DateTime.UtcNow.Year &#8226; DayLog</small>
        </footer>
    </div>
</div>

@code {
    private bool _sidebarCollapsed;
    private bool _checkedAuth = false;

    protected override async Task OnInitializedAsync()
    {
        // Only check auth if not already on /login
        if (!Navigation.Uri.EndsWith("/login", StringComparison.OrdinalIgnoreCase))
        {
            var loggedIn = await AuthService.IsLoggedInAsync();
            if (!loggedIn)
            {
                Navigation.NavigateTo("/login", true);
                return;
            }
        }
        _checkedAuth = true;
    }

    private void ToggleSidebar()
    {
        _sidebarCollapsed = !_sidebarCollapsed;
    }
        }
        _checkedAuth = true;
    }
>>>>>>> ecb1992 (Login Page)

    private void ToggleSidebar()
    {
        _sidebarCollapsed = !_sidebarCollapsed;
        // Toggle a CSS class on root element via JS interop is possible;
        // simpler: toggle a CSS class on sidebar by binding class attribute
        // We'll use CSS that responds to .collapsed on the body
        // so we set/unset a CSS class on document body (optional).
    }
}
<<<<<<< HEAD
=======

@if (_checkedAuth || Navigation.Uri.EndsWith("/login", StringComparison.OrdinalIgnoreCase))
{
    <div class="app-shell">
        <aside class="sidebar" role="navigation">
            <div class="sidebar-inner">
                <div class="brand">
                    <img src="images/appicon.svg" alt="logo" />
                    <span class="brand-title">DayLog</span>
                </div>

                <NavMenu />
            </div>
        </aside>

        <div class="content-area">
            <header class="topbar">
                <button class="hamburger d-lg-none" @onclick="ToggleSidebar" aria-label="Toggle navigation">
                    ☰
                </button>

                <div class="topbar-right">
                    <!-- optional: page title, user actions -->
                </div>
            </header>

            <main class="main-container">
                @Body
            </main>

            <footer class="app-footer">
                <small>© @DateTime.UtcNow.Year • DayLog</small>
            </footer>
        </div>
    </div>
}
>>>>>>> ecb1992 (Login Page)
